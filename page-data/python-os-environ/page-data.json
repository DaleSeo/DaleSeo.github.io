{"componentChunkName":"component---src-templates-detail-template-jsx","path":"/python-os-environ/","result":{"pageContext":{"previous":{"fields":{"slug":"/python-logging-config/"},"frontmatter":{"title":"파이썬 로깅 설정 - logger, handler, formatter"}},"node":{"html":"<p>여러 환경에 파이썬 애플리케이션을 배포하려면 환경 변수라는 것을 이용해야하는데요.\n이번 포스팅에서는 파이썬에서 환경 변수에 어떻게 접근하고 설정할 수 있는지에 대해서 알아보겠습니다.</p>\n<h2 id=\"환경-변수란\" style=\"position:relative;\"><a href=\"#%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98%EB%9E%80\" aria-label=\"환경 변수란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>환경 변수란?</h2>\n<p>먼저 환경 변수(environment variable)가 무엇인지 간단하게 짚고 넘어가면 좋을 것 같은데요.\n환경 변수는 운영 체제(operating system) 수준에서 설정되는 변수로, 주로 애플레케이션 수준에서 설정하기가 불가능하거나 어려운 값들을 환경 변수로 관리하는 경우가 많죠.</p>\n<p>환경 변수를 이용하면 애플리케이션 코드를 수정하지 않고도 개발, 테스트, 운영 등 배포 환경에 따라 설정값을 유연하게 변경할 수 있어서 이식성(portability)과 유지 보수성 측면에서 큰 이점이 있습니다.</p>\n<p>대표적인 예로, 데이터베이스(DB) 설정을 들 수 있는데요. 운영 환경에서는 데이터 센터나 클라우드 인프라 상의 상용 DB를 사용하고, 개발 환경에서는 개발자의 PC 상에서 로컬 DB를 사용하는 경우에 환경 변수를 이용해서 각 환경 별로 데이터베이스 설정을 관리하는 경우가 많습니다.</p>\n<p>뿐만 아니라, 데이터베이스의 비밀번호나 서드파티(3rd-party) 서비스의 API 키와 같이 민감한 인증 정보는 GitHub와 같은 코드 저장소(repository)에 올리면 상당히 위험할 수 있기 때문에 환경 변수로 저장해놓고 사용하는 것이 권장됩니다.</p>\n<h2 id=\"os-내장-모듈\" style=\"position:relative;\"><a href=\"#os-%EB%82%B4%EC%9E%A5-%EB%AA%A8%EB%93%88\" aria-label=\"os 내장 모듈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>os 내장 모듈</h2>\n<p>파이썬으로 작성된 애플리케이션에서는 기본적으로 내장되어 있는 <code>os</code> 모듈을 통해서 운영 체제의 환경 변수 값을 읽어올 수 있습니다.\n우선, 파이썬 인터프리터를 실행한 후, <code>os</code> 모듈을 임포트하는 것 부터 시작하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\">$ python\nPython <span class=\"token number\">3.8</span><span class=\"token number\">.1</span> <span class=\"token punctuation\">(</span>default<span class=\"token punctuation\">,</span> Jan <span class=\"token number\">11</span> <span class=\"token number\">2020</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">:</span><span class=\"token number\">11</span><span class=\"token punctuation\">:</span><span class=\"token number\">31</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span>Clang <span class=\"token number\">11.0</span><span class=\"token number\">.0</span> <span class=\"token punctuation\">(</span>clang<span class=\"token operator\">-</span><span class=\"token number\">1100.0</span><span class=\"token number\">.33</span><span class=\"token number\">.16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> on darwin\nType <span class=\"token string\">\"help\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"copyright\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"credits\"</span> <span class=\"token keyword\">or</span> <span class=\"token string\">\"license\"</span> <span class=\"token keyword\">for</span> more information<span class=\"token punctuation\">.</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> os</code></pre></div>\n<h2 id=\"osenviron-속성\" style=\"position:relative;\"><a href=\"#osenviron-%EC%86%8D%EC%84%B1\" aria-label=\"osenviron 속성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>os.environ 속성</h2>\n<p>운영 체제에 등록되어 있는 모든 환경 변수는 <code>os</code> 모듈의 <code>environ</code>이라는 속성을 통해서 접근이 가능합니다.\n이 <code>os.environ</code> 속성은 마치 파이썬 내장 자료 구조인 사전(dictionary)을 사용하듯이 사용할 수 있습니다.</p>\n<p>예를 들어, 환경 변수 <code>HOME</code>에 저장되어 있는 값은 다음과 같이 읽어올 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> os<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">[</span><span class=\"token string\">'HOME'</span><span class=\"token punctuation\">]</span>\n<span class=\"token string\">'/Users/dale'</span></code></pre></div>\n<p>파이썬의 사전이 존재하지 않는 키를 넘길 경우, <code>KeyError</code>를 발생시키는 것처럼, <code>os.environ</code>도 동일하게 동작합니다.\n그래서 애플리케이션 코드를 작성할 때는 환경 변수가 존재하지 않는 경우에 대한 적당한 예외 처리를 해줘야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> os<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">[</span><span class=\"token string\">'ENV'</span><span class=\"token punctuation\">]</span>\nTraceback <span class=\"token punctuation\">(</span>most recent call last<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  File <span class=\"token string\">\"&lt;stdin>\"</span><span class=\"token punctuation\">,</span> line <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">in</span> <span class=\"token operator\">&lt;</span>module<span class=\"token operator\">></span>\n  File <span class=\"token string\">\"/Users/dale/.pyenv/versions/3.8.1/lib/python3.8/os.py\"</span><span class=\"token punctuation\">,</span> line <span class=\"token number\">673</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">in</span> __getitem__\n    <span class=\"token keyword\">raise</span> KeyError<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> <span class=\"token boolean\">None</span>\nKeyError<span class=\"token punctuation\">:</span> <span class=\"token string\">'ENV'</span></code></pre></div>\n<p>어떤 환경 변수가 없을 때, 예외를 발생시키는 대신에 <code>None</code>을 반환받고 싶은 경우에는 사전과 동일하게 <code>get()</code> 메서드를 사용하면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">assert</span> os<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'ENV'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span></code></pre></div>\n<p><code>get()</code> 메서드의 두 번째 인자로 기본값을 넘길 수도 있습니다. 꼭 설정해주지 않아도 되는 환경 변수에 유용하게 사용됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> os<span class=\"token punctuation\">.</span>environ<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'ENV'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'development'</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">'development'</span></code></pre></div>\n<h2 id=\"osgetenv-함수\" style=\"position:relative;\"><a href=\"#osgetenv-%ED%95%A8%EC%88%98\" aria-label=\"osgetenv 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>os.getenv 함수</h2>\n<p><code>os</code> 모듈의 <code>getenv()</code> 함수를 사용하면 좀 더 간결한 코드로 <code>os.environ.get()</code> 함수와 동일한 효과를 얻을 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"py\"><pre class=\"language-py\"><code class=\"language-py\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">assert</span> os<span class=\"token punctuation\">.</span>getenv<span class=\"token punctuation\">(</span><span class=\"token string\">'ENV'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> os<span class=\"token punctuation\">.</span>getenv<span class=\"token punctuation\">(</span><span class=\"token string\">'ENV'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'development'</span><span class=\"token punctuation\">)</span>\n<span class=\"token string\">'development'</span></code></pre></div>\n<h2 id=\"환경-변수-관련-다른-함수들\" style=\"position:relative;\"><a href=\"#%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%EA%B4%80%EB%A0%A8-%EB%8B%A4%EB%A5%B8-%ED%95%A8%EC%88%98%EB%93%A4\" aria-label=\"환경 변수 관련 다른 함수들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>환경 변수 관련 다른 함수들</h2>\n<p><code>os</code> 모듈에는 새로운 환경 변수를 추가해주는 <code>putenv()</code>나 기존 환경 변수를 제거해주는 <code>unsetenv()</code>와 같은 함수들도 있는데 매우 주의해서 사용해야 합니다.\n왜냐하면 이러한 함수들로 운영 체제 상의 환경 변수를 변경하였더라도, <code>os</code> 모듈이 최초 임포트될 때 이미 세팅되었던 <code>os.environ</code>에는 반영이 되지 않기 때문입니다.\n따라서 이렇게 환경 변수를 조작하는 함수를 직접 사용하는 것 보다는 <code>os.environ</code>를 통해서 마치 사전 다루듯이 환경 변수를 추가/제거 하는 것이 더 안전 합니다.\n무엇보다 맨 처음에 설명드린 환경 변수의 용도를 생각해보면 대부분 환경 변수는 애플리케이션 레벨에서는 읽기 전용으로 쓰이는 것이 대부분일 것입니다.</p>\n<h2 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h2>\n<ul>\n<li><a href=\"https://docs.python.org/3/library/os.html\">파이썬 공식 레퍼런스: os — Miscellaneous operating system interfaces</a></li>\n</ul>","timeToRead":3,"fields":{"slug":"/python-os-environ/","tags":["Python","env"]},"frontmatter":{"title":"파이썬에서 환경 변수 읽어오기 (os.environ)","date":"Feb 29, 2020"}},"next":{"fields":{"slug":"/graphql-react-apollo-subscriptions/"},"frontmatter":{"title":"[GraphQL] React Apollo로 Subscription 호출"}}}},"staticQueryHashes":["2168229929","2362167539","3056348342"]}