{
    "componentChunkName": "component---src-templates-detail-template-jsx",
    "path": "/rust-rc/",
    "result": {"pageContext":{"previous":null,"node":{"html":"<p>Rust의 소유권 시스템은 “한 번에 하나의 소유자만 존재할 수 있다”는 명확한 규칙을 가지고 있습니다.\n대부분의 경우 이 규칙만으로 충분하지만, 때로는 여러 부분에서 같은 데이터를 소유해야 하는 상황이 있습니다.\n예를 들어 그래프 자료구조에서 여러 노드가 같은 노드를 가리켜야 할 수 있습니다.</p>\n<p>단일 스레드 환경에서 이런 공유 소유권이 필요할 때 Rc(Reference Counted)를 사용합니다.\nRc는 참조 카운팅을 통해 여러 소유자가 같은 데이터를 공유할 수 있게 해주는 스마트 포인터입니다.\n데이터를 가리키는 참조가 몇 개인지 추적하고, 마지막 참조가 사라질 때 메모리를 자동으로 해제합니다.</p>\n<p>이 글에서는 Rc가 무엇이고, 어떻게 사용하는지, 그리고 순환 참조 문제를 어떻게 해결하는지 살펴보겠습니다.\n소유권과 빌림의 기본 개념은 <a href=\"/rust-ownership/\">소유권과 빌림</a> 글에서 다루고 있으니 참고하시기 바랍니다.</p>\n<h2 id=\"rc가-필요한-이유\" style=\"position:relative;\"><a href=\"#rc%EA%B0%80-%ED%95%84%EC%9A%94%ED%95%9C-%EC%9D%B4%EC%9C%A0\" aria-label=\"rc가 필요한 이유 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Rc가 필요한 이유</h2>\n<p>소유권 규칙에 따르면 값은 정확히 하나의 소유자만 가질 수 있습니다.\n하지만 여러 부분에서 같은 데이터를 읽어야 하는 경우가 있습니다.\n참조를 사용할 수도 있지만, 참조는 라이프타임 제약이 있어서 복잡한 자료구조를 만들 때 불편합니다.</p>\n<p>대표적인 예가 그래프 자료구조입니다.\n여러 노드가 같은 노드를 참조해야 하는 상황이 있는데, 이런 구조를 일반 소유권 규칙만으로 표현하기는 어렵습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">struct</span> <span class=\"token type-definition class-name\">Node</span> <span class=\"token punctuation\">{</span>\n    value<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">,</span>\n    neighbors<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Vec</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Box</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Node</span><span class=\"token operator\">>></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> shared <span class=\"token operator\">=</span> <span class=\"token class-name\">Box</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n        neighbors<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> node1 <span class=\"token operator\">=</span> <span class=\"token class-name\">Node</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">// 오류! shared의 소유권을 이동할 수 없음</span>\n        neighbors<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span>shared<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> node2 <span class=\"token operator\">=</span> <span class=\"token class-name\">Node</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">// shared는 이미 이동됨</span>\n        neighbors<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span>shared<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위 코드는 노드 1과 2가 모두 노드 3을 이웃으로 참조하려는 그래프 구조입니다.\n하지만 <code>Box</code>를 사용하면 소유권이 이동하기 때문에, <code>shared</code>를 <code>node1</code>과 <code>node2</code>에서 동시에 사용할 수 없습니다.\n이런 상황에서 Rc를 사용하면 여러 노드가 같은 노드를 공유할 수 있습니다.</p>\n<p>Rc는 단일 스레드 환경에서만 사용할 수 있습니다.\n멀티스레드 환경에서 데이터를 공유하려면 <a href=\"/rust-arc/\">Arc</a>를 사용해야 합니다.</p>\n<h2 id=\"rc-기본-사용법\" style=\"position:relative;\"><a href=\"#rc-%EA%B8%B0%EB%B3%B8-%EC%82%AC%EC%9A%A9%EB%B2%95\" aria-label=\"rc 기본 사용법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Rc 기본 사용법</h2>\n<p>Rc는 <code>Rc::new()</code>로 생성합니다.\nRc를 복제하면 데이터가 복사되는 것이 아니라, 같은 데이터를 가리키는 새로운 Rc가 만들어지고 참조 카운트가 증가합니다.\n모든 Rc가 drop될 때 참조 카운트가 0이 되면, 그때 비로소 데이터가 메모리에서 해제됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">use</span> <span class=\"token namespace\">std<span class=\"token punctuation\">::</span>rc<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> data <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">::</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"공유 데이터\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"참조 카운트: {}\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">strong_count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> data2 <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">let</span> data3 <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"참조 카운트: {}\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">strong_count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터: {}\"</span><span class=\"token punctuation\">,</span> data2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"참조 카운트: {}\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">strong_count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-code-title\">결과</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">참조 카운트: <span class=\"token number\">1</span>\n참조 카운트: <span class=\"token number\">3</span>\n데이터: 공유 데이터\n참조 카운트: <span class=\"token number\">1</span></code></pre></div>\n<p>처음 <code>data</code>를 생성했을 때 참조 카운트는 1입니다.\n<code>data2</code>와 <code>data3</code>를 복제하면 참조 카운트가 3으로 증가합니다.\n세 개의 Rc가 모두 같은 <code>String</code> 데이터를 가리키고 있습니다.\n내부 스코프를 벗어나면 <code>data2</code>와 <code>data3</code>가 drop되면서 참조 카운트가 다시 1로 감소합니다.</p>\n<p><code>Rc::clone(&#x26;rc)</code>은 데이터를 깊게 복사하지 않고, 단순히 참조 카운트만 증가시키는 저렴한 연산입니다.\n<code>rc.clone()</code>과 동일하지만, <code>Rc::clone()</code>을 명시적으로 사용하면 이것이 얕은 복사임을 코드를 읽는 사람에게 명확히 알릴 수 있습니다.</p>\n<p>앞서 본 그래프 예제를 Rc로 구현하면 다음과 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">use</span> <span class=\"token namespace\">std<span class=\"token punctuation\">::</span>rc<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token type-definition class-name\">Node</span> <span class=\"token punctuation\">{</span>\n    value<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">,</span>\n    neighbors<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Vec</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Rc</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Node</span><span class=\"token operator\">>></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> shared <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n        neighbors<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> node1 <span class=\"token operator\">=</span> <span class=\"token class-name\">Node</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        neighbors<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>shared<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> node2 <span class=\"token operator\">=</span> <span class=\"token class-name\">Node</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n        neighbors<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>shared<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"shared 참조 카운트: {}\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">strong_count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>shared<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-code-title\">결과</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">shared 참조 카운트: <span class=\"token number\">3</span></code></pre></div>\n<p>노드 1과 2가 모두 같은 노드 3을 이웃으로 공유합니다.\n참조 카운트가 3인 이유는 원래의 <code>shared</code>와 두 노드(node1, node2)가 가진 복제본 때문입니다.\n이렇게 Rc를 사용하면 여러 노드가 같은 노드를 공유하는 그래프 구조를 자연스럽게 표현할 수 있습니다.</p>\n<h2 id=\"rc의-불변성과-내부-가변성\" style=\"position:relative;\"><a href=\"#rc%EC%9D%98-%EB%B6%88%EB%B3%80%EC%84%B1%EA%B3%BC-%EB%82%B4%EB%B6%80-%EA%B0%80%EB%B3%80%EC%84%B1\" aria-label=\"rc의 불변성과 내부 가변성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Rc의 불변성과 내부 가변성</h2>\n<p>Rc가 제공하는 것은 불변 참조입니다.\n여러 소유자가 있기 때문에, 누군가 데이터를 수정하면 다른 소유자에게 예상치 못한 영향을 줄 수 있습니다.\n따라서 Rc를 통해서는 데이터를 읽을 수만 있고 수정할 수 없습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">use</span> <span class=\"token namespace\">std<span class=\"token punctuation\">::</span>rc<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> data <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">::</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"안녕\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 오류! Rc는 불변 참조만 제공</span>\n    <span class=\"token comment\">// data.push_str(\" 하세요\");</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Rc를 통해 데이터를 수정하려면 내부 가변성(interior mutability)을 제공하는 타입과 함께 사용해야 합니다.\n<code>RefCell</code>이 대표적입니다.\n<code>Rc&#x3C;RefCell&#x3C;T>></code> 패턴을 사용하면 여러 소유자가 데이터를 공유하면서도 런타임에 빌림 규칙을 검사하여 안전하게 수정할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">use</span> <span class=\"token namespace\">std<span class=\"token punctuation\">::</span>rc<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token namespace\">std<span class=\"token punctuation\">::</span>cell<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">RefCell</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> data <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RefCell</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">::</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"안녕\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> data2 <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    data2<span class=\"token punctuation\">.</span><span class=\"token function\">borrow_mut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">push_str</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" 하세요\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터: {}\"</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">borrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-code-title\">결과</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">데이터: 안녕 하세요</code></pre></div>\n<p><code>RefCell</code>의 <code>borrow_mut()</code>를 호출하면 가변 참조를 얻을 수 있습니다.\n빌림 규칙은 런타임에 검사되므로, 규칙을 위반하면 패닉이 발생합니다.\n하지만 대부분의 경우 Rc는 읽기 전용으로 사용하는 것이 더 안전하고 명확합니다.</p>\n<h2 id=\"순환-참조와-메모리-누수\" style=\"position:relative;\"><a href=\"#%EC%88%9C%ED%99%98-%EC%B0%B8%EC%A1%B0%EC%99%80-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EB%88%84%EC%88%98\" aria-label=\"순환 참조와 메모리 누수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>순환 참조와 메모리 누수</h2>\n<p>Rc를 사용할 때 주의해야 할 점은 순환 참조(circular reference) 문제입니다.\n예를 들어 그래프에서 두 노드가 서로를 가리키면 참조 카운트가 절대 0이 되지 않아 메모리 누수가 발생할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">use</span> <span class=\"token namespace\">std<span class=\"token punctuation\">::</span>rc<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token namespace\">std<span class=\"token punctuation\">::</span>cell<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">RefCell</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token type-definition class-name\">Node</span> <span class=\"token punctuation\">{</span>\n    value<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">,</span>\n    neighbors<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Vec</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Rc</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">RefCell</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Node</span><span class=\"token operator\">>></span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> node1 <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RefCell</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        neighbors<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> node2 <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RefCell</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n        neighbors<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 순환 참조 생성: node1 -> node2, node2 -> node1</span>\n    node1<span class=\"token punctuation\">.</span><span class=\"token function\">borrow_mut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>neighbors<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>node2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    node2<span class=\"token punctuation\">.</span><span class=\"token function\">borrow_mut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>neighbors<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>node1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"node1 참조 카운트: {}\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">strong_count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>node1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"node2 참조 카운트: {}\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">strong_count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>node2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-code-title\">결과</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">node1 참조 카운트: <span class=\"token number\">2</span>\nnode2 참조 카운트: <span class=\"token number\">2</span></code></pre></div>\n<p>node1과 node2가 서로를 이웃으로 가리키는 순환 구조입니다.\n함수가 끝나도 각 노드의 참조 카운트는 1로 남아 있어 메모리가 해제되지 않습니다.\n이것이 순환 참조로 인한 메모리 누수입니다.</p>\n<p>이 문제를 해결하려면 약한 참조(weak reference)인 <code>Weak</code>를 사용해야 합니다.\n<code>Weak</code>는 참조 카운트를 증가시키지 않는 참조입니다.\n<code>Rc::downgrade()</code>를 호출하면 <code>Weak</code> 참조를 얻을 수 있고, <code>Weak::upgrade()</code>를 호출하면 다시 <code>Rc</code>로 변환할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">use</span> <span class=\"token namespace\">std<span class=\"token punctuation\">::</span>rc<span class=\"token punctuation\">::</span></span><span class=\"token punctuation\">{</span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Weak</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token namespace\">std<span class=\"token punctuation\">::</span>cell<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">RefCell</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token type-definition class-name\">Node</span> <span class=\"token punctuation\">{</span>\n    value<span class=\"token punctuation\">:</span> <span class=\"token keyword\">i32</span><span class=\"token punctuation\">,</span>\n    neighbors<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Vec</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Rc</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">RefCell</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Node</span><span class=\"token operator\">>></span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n    back_edges<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Vec</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Weak</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">RefCell</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Node</span><span class=\"token operator\">>></span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> node1 <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RefCell</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        neighbors<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        back_edges<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">let</span> node2 <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RefCell</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Node</span> <span class=\"token punctuation\">{</span>\n        value<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n        neighbors<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        back_edges<span class=\"token punctuation\">:</span> <span class=\"token macro property\">vec!</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// node1 -> node2 강한 참조 (순방향 간선)</span>\n    node1<span class=\"token punctuation\">.</span><span class=\"token function\">borrow_mut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>neighbors<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">clone</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>node2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// node2 -> node1 약한 참조 (역방향 간선)</span>\n    node2<span class=\"token punctuation\">.</span><span class=\"token function\">borrow_mut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>back_edges<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">downgrade</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>node1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"node1 강한 참조: {}\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">strong_count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>node1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"node1 약한 참조: {}\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">weak_count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>node1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"node2 강한 참조: {}\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">strong_count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>node2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-code-title\">결과</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">node1 강한 참조: <span class=\"token number\">1</span>\nnode1 약한 참조: <span class=\"token number\">1</span>\nnode2 강한 참조: <span class=\"token number\">2</span></code></pre></div>\n<p>node1은 node2를 강한 참조(<code>Rc</code>)로 가리키고, node2는 node1을 약한 참조(<code>Weak</code>)로 가리킵니다.\n이렇게 하면 순환 참조가 있어도 메모리 누수가 발생하지 않습니다.\nnode1의 강한 참조 카운트가 0이 되면 node1이 해제되고, 그러면 node2도 해제됩니다.</p>\n<p><code>Weak</code>는 데이터가 이미 해제되었을 수 있으므로, <code>upgrade()</code>는 <code>Option&#x3C;Rc&#x3C;T>></code>를 반환합니다.\n데이터가 아직 살아있으면 <code>Some(Rc&#x3C;T>)</code>를, 이미 해제되었으면 <code>None</code>을 반환합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"rust\"><pre class=\"language-rust\"><code class=\"language-rust\"><span class=\"token keyword\">use</span> <span class=\"token namespace\">std<span class=\"token punctuation\">::</span>rc<span class=\"token punctuation\">::</span></span><span class=\"token punctuation\">{</span><span class=\"token class-name\">Rc</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Weak</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> strong <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> weak<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Weak</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">i32</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token class-name\">Rc</span><span class=\"token punctuation\">::</span><span class=\"token function\">downgrade</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>strong<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 데이터가 살아있을 때</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">let</span> <span class=\"token class-name\">Some</span><span class=\"token punctuation\">(</span>rc<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> weak<span class=\"token punctuation\">.</span><span class=\"token function\">upgrade</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"값: {}\"</span><span class=\"token punctuation\">,</span> rc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">drop</span><span class=\"token punctuation\">(</span>strong<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 데이터가 해제된 후</span>\n    <span class=\"token keyword\">if</span> weak<span class=\"token punctuation\">.</span><span class=\"token function\">upgrade</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">is_none</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token macro property\">println!</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"데이터가 해제되었습니다\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-code-title\">결과</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">값: <span class=\"token number\">42</span>\n데이터가 해제되었습니다</code></pre></div>\n<h2 id=\"rc-vs-arc\" style=\"position:relative;\"><a href=\"#rc-vs-arc\" aria-label=\"rc vs arc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Rc vs Arc</h2>\n<p>Rc는 단일 스레드 환경에서만 사용할 수 있습니다.\n참조 카운트를 일반 정수로 관리하기 때문에, 여러 스레드에서 동시에 접근하면 데이터 경쟁이 발생할 수 있습니다.\n실제로 Rc를 스레드 간에 전송하려고 하면 컴파일 오류가 발생합니다.</p>\n<p>멀티스레드 환경에서는 Arc(Atomic Reference Counted)를 사용해야 합니다.\nArc는 원자적 연산을 사용하여 참조 카운트를 관리하므로 스레드 안전합니다.\n다만 원자적 연산은 일반 정수 연산보다 느리기 때문에, 단일 스레드 환경에서는 Rc를 사용하는 것이 더 효율적입니다.</p>\n<p>언제 무엇을 사용할지 정리하면 다음과 같습니다.\n단일 스레드에서 공유 소유권이 필요하면 Rc를 사용하세요.\n멀티스레드에서 공유 소유권이 필요하면 Arc를 사용하세요.\n데이터를 수정해야 한다면 Rc는 <code>RefCell</code>과, Arc는 <code>Mutex</code>와 함께 사용하세요.</p>\n<p>Arc에 대한 자세한 내용은 <a href=\"/rust-arc/\">Arc로 스레드 간 데이터 공유하기</a> 글을 참고하시기 바랍니다.</p>\n<h2 id=\"마치며\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"마치며 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마치며</h2>\n<p>Rc는 참조 카운팅을 통해 단일 스레드 환경에서 여러 소유자가 같은 데이터를 공유할 수 있게 해주는 스마트 포인터입니다.\n그래프 같은 복잡한 자료구조를 만들 때 유용하며, 참조 카운트가 자동으로 관리되므로 메모리를 직접 관리할 필요가 없습니다.</p>\n<p>순환 참조로 인한 메모리 누수를 방지하려면 <code>Weak</code> 참조를 적절히 사용해야 합니다.\n그래프에서는 순방향 간선은 강한 참조로, 역방향 간선은 약한 참조로 구분하는 패턴이 일반적입니다.\n이렇게 하면 소유권 계층이 명확해지고 메모리 누수를 방지할 수 있습니다.</p>\n<p>Rc는 불변 참조만 제공하므로, 데이터를 수정하려면 <code>RefCell</code> 같은 내부 가변성 타입과 함께 사용해야 합니다.\n하지만 가능하면 불변으로 유지하는 것이 더 안전하고 이해하기 쉽습니다.</p>\n<p>소유권과 빌림의 기본 개념은 <a href=\"/rust-ownership/\">소유권과 빌림</a> 글을 참고하시기 바랍니다.\n멀티스레드 환경에서의 공유 소유권은 <a href=\"/rust-arc/\">Arc로 스레드 간 데이터 공유하기</a> 글에서 다루고 있습니다.</p>","timeToRead":7,"fields":{"slug":"/rust-rc/","tags":["Rust","Rc"]},"frontmatter":{"title":"Rust 기초: Rc로 단일 스레드에서 데이터 공유하기","date":"Dec 5, 2025"}},"next":{"fields":{"slug":"/git-head/"},"frontmatter":{"title":"Git에서 HEAD란 무엇인가?"}}}},
    "staticQueryHashes": ["2168229929","2362167539","3056348342"]}