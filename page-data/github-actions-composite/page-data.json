{
    "componentChunkName": "component---src-templates-detail-template-jsx",
    "path": "/github-actions-composite/",
    "result": {"pageContext":{"previous":{"fields":{"slug":"/nestjs-guards/"},"frontmatter":{"title":"가드(Guard)로 NestJS 앱 보호하기"}},"node":{"html":"<p>많은 분들이 GitHub Actions을 사용하실 때 <a href=\"https://github.com/marketplace?type=actions\">GitHub Marketplace</a>에 공개된 액션을 사용하실텐데요.\n만약에 필요한 액션을 찾지 못했거나 회사에 보안 상의 이유로 승인되지 않은 외부 액션을 사용할 수 없다면 어떻게 해야할까요?</p>\n<p>이번 글에서는 GitHub Actions에서 직접 액션을 만들어보고 워크플로우에서 사용하거나 GitHub Marketplace를 통해 공유하는 방법에 대해서 알아보겠습니다.</p>\n<h2 id=\"액션의-종류\" style=\"position:relative;\"><a href=\"#%EC%95%A1%EC%85%98%EC%9D%98-%EC%A2%85%EB%A5%98\" aria-label=\"액션의 종류 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>액션의 종류</h2>\n<p>GitHub Actions에서는 도커(Docker) 컨테이너 액션, 자바스크립트 액션, 복합(composite) 액션, 이렇게 3가지 형태의 액션을 만들 수 있는데요.</p>\n<p>도커 컨테이너 리눅스에서만 실행할 수 있다는 제한이 있고 도커에 대한 지식이 필요하며, 자바스크립트 액션은 관련 <a href=\"https://github.com/actions/toolkit\">도구 키트</a>를 어떻게 쓰는지 별도로 학습해야 합니다.</p>\n<p>따라서 본 글에서는 만들기 제일 간단한 간단한 합성 액션을 한번 만들어보려고 합니다.\n합성 액션을 통해서 우리는 여러 워크플로우에서 재사용이 가능한 여러 단계로 이루어진 하나의 액션을 만들 수 있습니다.</p>\n<h2 id=\"액션의-위치\" style=\"position:relative;\"><a href=\"#%EC%95%A1%EC%85%98%EC%9D%98-%EC%9C%84%EC%B9%98\" aria-label=\"액션의 위치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>액션의 위치</h2>\n<p>액션은 사설 저장소(private repository)에도 생성할 수 있고, 공개 저장소(public repository)에도 생성할 수 있는데요.\n보통 어떤 조직에서 내부적으로 액션을 공유하고 싶을 때 사설 저장소에 액션을 두고, 액션을 조직 외부까지 공개하고 싶을 때는 공개 저장소에 액션을 올립니다.</p>\n<p>만약에 액션이 활용 범위가 넓지 않아 특정 저장소 내의 워크플로우에서만 사용하고 싶다면 <code>.github/actions/</code> 디렉토리 안에 액션을 관리할 수도 있습니다.</p>\n<p>저는 액션을 만들어서 GitHub Marketplace까지 올려볼 것이기 때문에 공개 저장소를 사용하겠습니다.</p>\n<h2 id=\"액션-생성\" style=\"position:relative;\"><a href=\"#%EC%95%A1%EC%85%98-%EC%83%9D%EC%84%B1\" aria-label=\"액션 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>액션 생성</h2>\n<p>실습을 위해서 우선 자신의 깃허브에 계정에 <code>calc-action</code>라는 이름으로 새로운 코드 저장소를 만들고 시작하겠습니다.</p>\n<p>그리고 프로젝트 최상위 디렉토리에 <code>action.yml</code>파일을 생성하고요.\n<code>name</code> 속성에 해당 액션의 이름을 넣어주셔야 합니다.</p>\n<p>덧셈과 뺄셈을 해주는 간단한 액션을 만들 것이기 때문에 일단 아래와 같이 작성해보았습니다.</p>\n<div class=\"gatsby-code-title\">action.yml</div>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Calc Action\n<span class=\"token key atrule\">runs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">using</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"composite\"</span>\n  <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"Hi<span class=\"token punctuation\">,</span> I'm a calculator action<span class=\"token tag\">!</span>\"\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash</code></pre></div>\n<p>복합 액션을 생성할 때는 <code>runs.using</code> 속성을 <code>composite</code>으로 설정해줘야 합니다.\n그리고 <code>runs.steps</code> 속성을 통해서 해당 액션에서 수행해야하는 작업 단계를 나열해줍니다.</p>\n<p>간 작업 단계에서는 <code>use</code> 속성을 사용해서 다른 액션을 명시하거나, <code>run</code> 속성을 하여 실행할 명령어를 직접 넣어줍니다.\n<code>run</code> 속성을 사용할 때는 반드시 <code>shell</code> 속성을 통해서 어떤 쉘을 사용할지를 반드시 명시해줘야 합니다.</p>\n<p>액션 파일의 문법이 워크플로우 파일의 문법과 비슷한 것 같지만 자세히 보면 조금씩 다른 부분이 있어서 주의가 필요합니다.</p>\n<h2 id=\"액션-사용\" style=\"position:relative;\"><a href=\"#%EC%95%A1%EC%85%98-%EC%82%AC%EC%9A%A9\" aria-label=\"액션 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>액션 사용</h2>\n<p>위 실습 액션은 공개 저장소에 생성했기 때문에 깃허브 내의 아무 저장소에서 사용해볼 수 있습니다.\n워크플로우 내의 특정 작업 단계의 <code>uses</code> 속성에 <code>소유자/저장소@브랜치</code> 형태로 사용할 액션을 가리켜주면 됩니다.</p>\n<p>저는 <code>calculate</code> 작업의 첫 번째 단계로 실습 액션을 사용해보겠습니다.</p>\n<div class=\"gatsby-code-title\">.github/workflows/main.yml</div>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Our Workflow\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> push\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">calculate</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> DaleSchool/calc<span class=\"token punctuation\">-</span>action@main</code></pre></div>\n<p>워크플로우를 저장한 후에 <code>Actions</code> 탭을 클릭하면 <code>calculate</code> 작업의 실행 결과를 확인할 수 있는데요.\n<code>Hi, I'm a calculator action!</code>라는 메세지가 실행 로그에 출력되면 액션이 정상적으로 작동하는 것입니다.</p>\n<div class=\"gatsby-code-title\">Log</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">☑️ Set up Job\n☑️ Run DaleSchool/calc-action@main\n<span class=\"gatsby-highlight-code-line\">▶ Run DaleSchool/calc-action@main</span><span class=\"gatsby-highlight-code-line\">▶ Run <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Hi, I'm a calculator action!\"</span></span><span class=\"gatsby-highlight-code-line\">Hi, I'm a calculator action<span class=\"token operator\">!</span></span>☑️ Complete Job</code></pre></div>\n<h2 id=\"입력-변수-설정\" style=\"position:relative;\"><a href=\"#%EC%9E%85%EB%A0%A5-%EB%B3%80%EC%88%98-%EC%84%A4%EC%A0%95\" aria-label=\"입력 변수 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>입력 변수 설정</h2>\n<p>액션에는 입력 값을 넘기면 재사용성을 높일 수 있는데요.\n액션 파일의 <code>inputs</code> 속성을 통해서 입력 변수를 명시할 수 있습니다.</p>\n<p>그럼 실습 액션이 두 개의 숫자를 받도록 <code>x</code>, <code>y</code>라는 입력 변수를 추가해볼까요?</p>\n<div class=\"gatsby-code-title\">action.yml</div>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Calc Action\n<span class=\"gatsby-highlight-code-line\"><span class=\"token key atrule\">inputs</span><span class=\"token punctuation\">:</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token key atrule\">x</span><span class=\"token punctuation\">:</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token key atrule\">y</span><span class=\"token punctuation\">:</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span></span><span class=\"token key atrule\">runs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">using</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"composite\"</span>\n  <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"Hi<span class=\"token punctuation\">,</span> I'm a calculator action<span class=\"token tag\">!</span>\"\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"x = $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.x <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> y = $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.y <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\"</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash</span></code></pre></div>\n<p>워크플로우에서 액션에 입력 값을 넘길 때는 <code>with</code> 속성을 사용합니다.</p>\n<div class=\"gatsby-code-title\">.github/workflows/main.yml</div>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Our Workflow\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> push\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">calculate</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> DaleSchool/calc<span class=\"token punctuation\">-</span>action@main\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token key atrule\">x</span><span class=\"token punctuation\">:</span> <span class=\"token number\">12</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token key atrule\">y</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span></span></code></pre></div>\n<p><code>calculate</code> 작업 로그를 보시면 입력값으로 넘긴 <code>12</code>와 <code>3</code>이 출력되는 것을 볼 수 있으실 것입니다.</p>\n<div class=\"gatsby-code-title\">Log</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">☑️ Set up Job\n☑️ Run DaleSchool/calc-action@main\n<span class=\"gatsby-highlight-code-line\">▶ Run DaleSchool/calc-action@main</span><span class=\"gatsby-highlight-code-line\">▶ Run <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Hi, I'm a calculator action!\"</span></span><span class=\"gatsby-highlight-code-line\">▶ Run <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"x = 12, y = 3\"</span></span><span class=\"gatsby-highlight-code-line\">x <span class=\"token operator\">=</span> <span class=\"token number\">12</span>, y <span class=\"token operator\">=</span> <span class=\"token number\">3</span></span>☑️ Complete Job</code></pre></div>\n<h2 id=\"출력-변수-설정\" style=\"position:relative;\"><a href=\"#%EC%B6%9C%EB%A0%A5-%EB%B3%80%EC%88%98-%EC%84%A4%EC%A0%95\" aria-label=\"출력 변수 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>출력 변수 설정</h2>\n<p>액션에 출력값이 있는 경우 <code>outputs</code> 속성을 사용하여 액션의 출력 변수를 설정해줄 수 있는데요.\n<code>outputs</code> 속성에서 각 작업 단계에서 전달해준 값을 읽기 위해서 GitHub Actions의 문맥(context)인 <code>steps.&#x3C;step_id>.outputs.&#x3C;output_name></code> 문법을 사용합니다.</p>\n<p>그럼 실습 액션에서 입력으로 넘어온 <code>x</code>와 <code>y</code>를 더한 결과와 뺀 결과를 각각 <code>plus</code>, <code>minus</code>로 출력해보겠습니다.</p>\n<div class=\"gatsby-code-title\">action.yml</div>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Calc Action\n<span class=\"token key atrule\">inputs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">x</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n  <span class=\"token key atrule\">y</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token key atrule\">outputs</span><span class=\"token punctuation\">:</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token key atrule\">plus</span><span class=\"token punctuation\">:</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.plus.outputs.result <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token key atrule\">minus</span><span class=\"token punctuation\">:</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.minus.outputs.result <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token key atrule\">runs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">using</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"composite\"</span>\n  <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"Hi<span class=\"token punctuation\">,</span> I'm a calculator action<span class=\"token tag\">!</span>\"\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"x = $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.x <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> y = $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.y <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\"\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> plus</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"result=$(($<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.x <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> + $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.y <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>))\" <span class=\"token punctuation\">></span><span class=\"token punctuation\">></span> $GITHUB_OUTPUT</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> minus</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"result=$(($<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.x <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.y <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>))\" <span class=\"token punctuation\">></span><span class=\"token punctuation\">></span> $GITHUB_OUTPUT</span><span class=\"gatsby-highlight-code-line\">      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash</span></code></pre></div>\n<p>쉘(shell)에서 덧셈과 뺄샘을 하기 위해서 <code>plus</code>와 <code>minus</code>라는 두 개의 작업 단계가 추가되었으며 각 단계에서 계산 결과를 <code>$GITHUB_OUTPUT</code> 환경 파일에 전달하고 있습니다.</p>\n<blockquote>\n<p>단계 간 출력 값을 전달하는 방법에 대해서는 <a href=\"/github-actions-steps/\">별도 글</a>에서 아주 자세히 설명하고 있습니다.</p>\n</blockquote>\n<p>이제 워크플로우에서 실습 액션을 사용하는 단계에 <code>id</code> 속성을 통해 식별자를 부여해줍니다.\n그 아래에 액션에서 나온 계선 결과를 출력하기 위한 단계를 추가하겠습니다.</p>\n<div class=\"gatsby-code-title\">.github/workflows/main.yml</div>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Our Workflow\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> push\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">calculate</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> calc</span>        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> DaleSchool/calc<span class=\"token punctuation\">-</span>action@main\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">x</span><span class=\"token punctuation\">:</span> <span class=\"token number\">12</span>\n          <span class=\"token key atrule\">y</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Print results</span><span class=\"gatsby-highlight-code-line\">        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token scalar string\">          echo \"x + y = ${{ steps.calc.outputs.plus }}\"</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token scalar string\">          echo \"x - y = ${{ steps.calc.outputs.minus }}\"</span></span></code></pre></div>\n<p><code>calculate</code> 작업 로그를 보시면 입력값으로 넘긴 <code>x</code>와 <code>y</code>의 뎃셈과 뺄샘 결과가 출력되는 것을 확인할 수 있습니다.</p>\n<div class=\"gatsby-code-title\">Log</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">☑️ Set up Job\n☑️ Run DaleSchool/calc-action@main\n▶ Run DaleSchool/calc-action@main\n▶ Run <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Hi, I'm a calculator action!\"</span>\n▶ Run <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"x = 12, y = 3\"</span>\nx <span class=\"token operator\">=</span> <span class=\"token number\">12</span>, y <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\n<span class=\"gatsby-highlight-code-line\">▶ Run <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"result=<span class=\"token variable\"><span class=\"token variable\">$((</span><span class=\"token number\">12</span> <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token variable\">))</span></span>\"</span> <span class=\"token operator\">>></span> <span class=\"token string\">\"<span class=\"token variable\">$GITHUB_OUTPUT</span>\"</span></span><span class=\"gatsby-highlight-code-line\">▶ Run <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"result=<span class=\"token variable\"><span class=\"token variable\">$((</span><span class=\"token number\">12</span> <span class=\"token operator\">-</span> <span class=\"token number\">3</span><span class=\"token variable\">))</span></span>\"</span> <span class=\"token operator\">>></span> <span class=\"token string\">\"<span class=\"token variable\">$GITHUB_OUTPUT</span>\"</span></span><span class=\"gatsby-highlight-code-line\">☑️ Print results</span><span class=\"gatsby-highlight-code-line\">▶ Run <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"x + y = 15\"</span></span><span class=\"gatsby-highlight-code-line\">x + y <span class=\"token operator\">=</span> <span class=\"token number\">15</span></span><span class=\"gatsby-highlight-code-line\">▶ Run <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"x - y = 9\"</span></span><span class=\"gatsby-highlight-code-line\">x - y <span class=\"token operator\">=</span> <span class=\"token number\">9</span></span>☑️ Complete Job</code></pre></div>\n<h2 id=\"액션-공개\" style=\"position:relative;\"><a href=\"#%EC%95%A1%EC%85%98-%EA%B3%B5%EA%B0%9C\" aria-label=\"액션 공개 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>액션 공개</h2>\n<p>우리가 만든 액션을 GitHub Marketplace을 올려서 누구나 쓸 수 있게 된다면 멋지겠죠?</p>\n<p>이를 위해서는 반드시 <code>description</code> 속성에 해당 액션에 대한 설명을 넣어줘야 하고요.\n필수적으로 <code>README.md</code> 파일에 액션 사용법을 간단히 적어줘야합니다.</p>\n<div class=\"gatsby-code-title\">action.yml</div>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Calc Action\n<span class=\"gatsby-highlight-code-line\"><span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> Calculate with Two Numbers</span><span class=\"token key atrule\">inputs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">x</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n  <span class=\"token key atrule\">y</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n<span class=\"token key atrule\">outputs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">plus</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.plus.outputs.result <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">minus</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> steps.minus.outputs.result <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n<span class=\"token key atrule\">runs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">using</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"composite\"</span>\n  <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"Hi<span class=\"token punctuation\">,</span> I'm a calculator action<span class=\"token tag\">!</span>\"\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"x = $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.x <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> y = $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.y <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\"\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> plus\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"result=$(($<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.x <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> + $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.y <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>))\" <span class=\"token punctuation\">></span><span class=\"token punctuation\">></span> \"$GITHUB_OUTPUT\"\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> minus\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"result=$(($<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.x <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.y <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>))\" <span class=\"token punctuation\">></span><span class=\"token punctuation\">></span> \"$GITHUB_OUTPUT\"\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash</code></pre></div>\n<p>그 다음에는 액션이 있는 깃허브 저장소에서 <code>v1</code> 태그와 함께 릴리스(release)를 생성합니다.\n이 때 <code>Publish this Action to the GitHub Marketplace</code> 체크 박스를 선택해주세요.</p>\n<p>드디어 GitHub Marketplace에 액션이 공개되었습니다! 🥳 정말 간단하죠?</p>\n<p>이제 이 액션을 사용하고 있는 모든 워크플로우의 <code>uses</code> 속성을 <code>소유자/저장소@태그</code> 형태로 갱신해주는 것이 좋습니다.\n추후 바뀔 수 있는 브랜치에 의존하는 것보다는 고정된 태그에 의존하는 것이 일반적으로 더 권장되기 때문입니다.</p>\n<div class=\"gatsby-code-title\">.github/workflows/main.yml</div>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Our Workflow\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span> push\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">calculate</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> calc\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> DaleSchool/calc<span class=\"token punctuation\">-</span>action@v1</span>        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">x</span><span class=\"token punctuation\">:</span> <span class=\"token number\">12</span>\n          <span class=\"token key atrule\">y</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> print results\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\"></span>\n<span class=\"token scalar string\">          echo \"x + y = ${{ steps.calc.outputs.plus }}\"</span>\n<span class=\"token scalar string\">          echo \"x - y = ${{ steps.calc.outputs.minus }}\"</span></code></pre></div>\n<h2 id=\"실습-코드\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C\" aria-label=\"실습 코드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실습 코드</h2>\n<p>본 포스팅에서 만든 액션은 GitHub Marketplace에 공개해두었습니다.</p>\n<ul>\n<li>액션: <a href=\"https://github.com/marketplace/actions/calc-action\">https://github.com/marketplace/actions/calc-action</a></li>\n</ul>\n<h2 id=\"마치면서\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B4%EC%84%9C\" aria-label=\"마치면서 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마치면서</h2>\n<p>지금까지 간단한 실습을 통해서 GitHub Actions에서 어떻게 액션을 직접 만들고 사용할 수 있는지에 대해서 알아보았습니다.\n그리고 GitHub Marketplace를 통해 액션을 공유하는 방법도 살펴보았습니다.</p>\n<p>참고로 액션은 <a href=\"/github-actions-reusable-workflows/\">재사용 가능한 워크플로우</a>처럼 빈번하게 반복되는 일련의 단계를 재사용하기 위해서도 활용할 수 있습니다. 차이점이라고 한다면 액션은 하나의 작업 내에서 여러 단계를 재사용하기 용이한 반면에 재사용 가능한 워크플로우는 여러 작업을 재사용하기 용이합니다. 액션을 라이브러리로 비유하지만 재사용 가능한 워크플로우는 프레임워크에 좀 더 가까울 것 같네요.</p>\n<blockquote>\n<p>GitHub Actions 관련 포스팅은 <a href=\"/?tag=GitHubActions\">GitHub Actions 태그</a>를 통해서 쉽게 만나보세요!</p>\n</blockquote>","timeToRead":7,"fields":{"slug":"/github-actions-composite/","tags":["GitHub","GitHubActions","CI","CD"]},"frontmatter":{"title":"GitHub Actions에서 나만의 액션(action) 만들기","date":"Jul 5, 2023"}},"next":{"fields":{"slug":"/partytown/"},"frontmatter":{"title":"지연 없는 서드파티 스크립트 로딩을 위한 Partytown 🎉"}}}},
    "staticQueryHashes": ["2168229929","2362167539","3056348342"]}